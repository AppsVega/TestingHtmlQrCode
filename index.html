<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Testing HTML QrCode</title>
</head>
<body>
    <h1>Leia QRCODES</h1>
    <div style="display: flex; justify-content: center;">
        <div id="reader" style="width: 500px;">

        </div>
    </div>
    <p id="cod">Codigo lido: </p>

    <script src="https://unpkg.com/html5-qrcode"></script>

    <script>
        function domready(fn){
            if (document.readyState === "complete" || document.readyState === "interactive"){
                setTimeout(fn, 1)
            }
            else{
                document.addEventListener("DOMContentLoaded", fn)
            }
        }   

        domready(function(){
            var myqr = document.getElementById("cod")
            var lastresult, countresult = 0

            function onScanSuccess(decodetext, decodeesult){
                if (decodetext !== lastresult){
                    countresult++
                    lastresult = decodetext

                    alert("Your QR is: " + decodetext,decodeesult)

                    myqr.innerHTML = `Codigo lido: ${decodetext}`
                }
            }

            var htmlscanner = new Html5QrcodeScanner(
                'reader',{fps:10,qrbox:250})
            
            htmlscanner.render(onScanSuccess)
        })
    </script>
</body>
</html>